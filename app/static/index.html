<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>GEO_RADIO</title>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --glass:      rgba(12, 15, 22, 0.15);
            --glass-rim:  rgba(255, 255, 255, 0.10);
            --glass-edge: rgba(255, 255, 255, 0.06);
            --accent:     #ff4400;
            --accent-dim: rgba(255, 68, 0, 0.30);
            --cyan:       #00d9ff;
            --fg:         #ced4df;
            --dim:        #48525e;
            --font:       'JetBrains Mono', monospace;
        }

        * { box-sizing: border-box; user-select: none; margin: 0; padding: 0; }

        body {
            background: #020308;
            overflow: hidden;
            color: var(--fg);
            font-family: var(--font);
            text-transform: uppercase;
        }

        #globe-container { width: 100vw; height: 100vh; }

        /* ── GLASS PANEL BASE ── */
        .panel {
            position: absolute;
            z-index: 100;
            background: var(--glass);
            backdrop-filter: blur(10px) saturate(160%);
            -webkit-backdrop-filter: blur(10px) saturate(160%);
            border: 1px solid var(--glass-edge);
            border-top: 1px solid var(--glass-rim);
            border-radius: 2px;
            box-shadow:
                0 20px 40px -8px rgba(0, 0, 0, 0.75),
                inset 0 1px 0 rgba(255, 255, 255, 0.04);
        }

        /* ── BRAND BOX (top-left) ── */
        #brand-box { top: 20px; left: 20px; width: 240px; }

        .brand-logo {
            padding: 14px 18px 12px;
            border-bottom: 1px solid var(--glass-edge);
            cursor: pointer;
            transition: opacity 0.15s;
        }
        .brand-logo:hover { opacity: 0.75; }
        .brand-logo h1 {
            font-size: 34px;
            font-weight: 800;
            line-height: 1;
            letter-spacing: -1px;
            color: var(--fg);
        }
        .brand-logo h1 span { color: var(--accent); }

        .brand-coords {
            display: flex;
            justify-content: space-between;
            padding: 8px 18px;
            font-size: 10px;
            font-weight: 500;
            color: var(--dim);
            letter-spacing: 0.05em;
        }

        /* ── STATUS BOX (top-right) ── */
        #status-box {
            top: 20px; right: 20px;
            display: flex;
            align-items: center;
            gap: 14px;
            padding: 9px 16px;
        }

        #scan-btn {
            font-family: var(--font);
            font-size: 9px;
            font-weight: 700;
            letter-spacing: 0.14em;
            color: var(--dim);
            background: none;
            border: 1px solid var(--glass-edge);
            border-radius: 1px;
            padding: 4px 10px;
            cursor: pointer;
            text-transform: uppercase;
            transition: color 0.2s, border-color 0.2s;
        }
        #scan-btn:hover { color: var(--fg); border-color: rgba(255, 255, 255, 0.14); }
        #scan-btn.active { color: var(--accent); border-color: var(--accent-dim); }

        .v-sep { width: 1px; height: 14px; background: var(--glass-edge); flex-shrink: 0; }

        #status-txt {
            font-size: 9px;
            font-weight: 700;
            letter-spacing: 0.14em;
            color: var(--dim);
            transition: color 0.3s;
        }
        #status-txt.live { color: var(--accent); }

        .led {
            width: 7px; height: 7px;
            background: var(--dim);
            border-radius: 50%;
            flex-shrink: 0;
            transition: background 0.3s, box-shadow 0.3s;
        }
        .led.active {
            background: var(--accent);
            box-shadow: 0 0 8px var(--accent), 0 0 3px var(--accent);
        }

        /* ── META BOX (bottom-left) ── */
        #meta-box { bottom: 20px; left: 20px; width: 340px; display: none; }

        .meta-head {
            display: flex;
            align-items: flex-start;
            justify-content: space-between;
            padding: 16px 18px 0;
        }
        .meta-content { flex: 1; min-width: 0; }

        .label {
            font-size: 9px;
            font-weight: 700;
            color: var(--dim);
            letter-spacing: 0.16em;
            margin-bottom: 5px;
        }

        #st-name {
            font-size: 15px;
            font-weight: 800;
            color: var(--fg);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            line-height: 1.2;
            margin-bottom: 12px;
        }

        .meta-row {
            display: flex;
            gap: 0;
            padding: 0 18px 10px;
            border-bottom: 1px solid var(--glass-edge);
        }
        .meta-cell {
            flex: 1;
        }
        .meta-cell + .meta-cell {
            padding-left: 16px;
            border-left: 1px solid var(--glass-edge);
        }

        #st-country, #st-local-time {
            font-size: 11px;
            font-weight: 700;
            color: var(--fg);
        }

        #st-tags {
            padding: 8px 18px;
            font-size: 10px;
            font-weight: 500;
            color: var(--dim);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            border-bottom: 1px solid var(--glass-edge);
        }

        #star-btn {
            font-size: 17px;
            line-height: 1;
            background: none;
            border: none;
            color: var(--dim);
            cursor: pointer;
            padding: 0 0 0 12px;
            flex-shrink: 0;
            transition: color 0.2s;
            font-family: var(--font);
        }
        #star-btn:hover { color: var(--fg); }
        #star-btn.active { color: var(--cyan); }

        /* visualizer */
        #visualizer-canvas {
            display: block;
            width: 100%;
            height: 38px;
        }

        #play-btn {
            display: block;
            width: 100%;
            padding: 13px 18px;
            background: rgba(255, 255, 255, 0.05);
            color: var(--fg);
            border: none;
            border-top: 1px solid var(--glass-edge);
            font-family: var(--font);
            font-size: 10px;
            font-weight: 800;
            letter-spacing: 0.16em;
            cursor: pointer;
            text-transform: uppercase;
            transition: background 0.2s, color 0.2s;
        }
        #play-btn:hover { background: var(--accent); color: #fff; }
        #play-btn.playing { color: var(--accent); }

        /* ── SEARCH BOX (bottom-right) ── */
        #search-box {
            bottom: 20px; right: 20px;
            width: 270px;
            padding: 14px 18px;
            transition: width 0.25s cubic-bezier(0.4, 0, 0.2, 1);
        }
        #search-box.expanded { width: 400px; }

        .search-row {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 8px;
        }

        #search-input {
            flex: 1;
            min-width: 0;
            background: transparent;
            border: none;
            border-bottom: 1px solid var(--glass-edge);
            color: var(--fg);
            font-family: var(--font);
            font-size: 13px;
            font-weight: 500;
            outline: none;
            padding-bottom: 5px;
            letter-spacing: 0.04em;
        }
        #search-input::placeholder { color: var(--dim); }
        #search-input:-webkit-autofill,
        #search-input:-webkit-autofill:focus {
            -webkit-box-shadow: 0 0 0 1000px transparent inset;
            -webkit-text-fill-color: var(--fg);
            transition: background-color 9999s ease;
        }

        .search-nav-btn {
            display: none;
            font-family: var(--font);
            font-size: 11px;
            font-weight: 700;
            color: var(--dim);
            background: none;
            border: 1px solid var(--glass-edge);
            border-radius: 1px;
            padding: 3px 8px;
            cursor: pointer;
            flex-shrink: 0;
            transition: color 0.15s, border-color 0.15s;
            line-height: 1;
        }
        #search-box.expanded .search-nav-btn { display: block; }
        .search-nav-btn:hover:not(:disabled) { color: var(--fg); border-color: rgba(255,255,255,0.14); }
        .search-nav-btn:disabled { opacity: 0.25; cursor: default; }

        .search-footer {
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        .search-label {
            font-size: 9px;
            font-weight: 700;
            letter-spacing: 0.16em;
            color: var(--dim);
        }
        #search-count {
            font-size: 9px;
            font-weight: 500;
            letter-spacing: 0.1em;
            color: var(--dim);
        }

        /* ── MODAL ── */
        #modal-overlay {
            display: none;
            position: fixed;
            inset: 0;
            z-index: 300;
            background: rgba(2, 3, 8, 0.72);
            align-items: center;
            justify-content: center;
        }
        #modal-overlay.open { display: flex; }

        #modal-box {
            position: relative;
            width: 460px;
            max-width: calc(100vw - 40px);
            background: rgba(7, 9, 16, 0.96);
            backdrop-filter: blur(28px) saturate(180%);
            -webkit-backdrop-filter: blur(28px) saturate(180%);
            border: 1px solid rgba(255, 255, 255, 0.09);
            border-top: 1px solid rgba(255, 255, 255, 0.18);
            box-shadow:
                0 40px 80px -16px rgba(0, 0, 0, 0.95),
                0 0 0 1px rgba(255, 255, 255, 0.03),
                inset 0 1px 0 rgba(255, 255, 255, 0.07);
        }

        #modal-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 18px 20px 16px;
            border-bottom: 1px solid var(--glass-edge);
        }
        #modal-header span {
            font-size: 22px;
            font-weight: 800;
            letter-spacing: -0.5px;
            color: var(--fg);
        }
        #modal-header span .accent { color: var(--accent); }

        #modal-close {
            background: none;
            border: none;
            color: var(--dim);
            font-family: var(--font);
            font-size: 14px;
            cursor: pointer;
            padding: 4px 6px;
            transition: color 0.15s;
            line-height: 1;
        }
        #modal-close:hover { color: var(--fg); }

        .modal-section {
            padding: 16px 20px;
        }
        .modal-section + .modal-section {
            border-top: 1px solid var(--glass-edge);
        }

        .modal-section .label { margin-bottom: 10px; }

        .modal-about-text {
            font-size: 10px;
            font-weight: 500;
            color: var(--dim);
            line-height: 1.8;
            letter-spacing: 0.04em;
            text-transform: none;
        }

        .setting-row {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 7px 0;
        }
        .setting-row + .setting-row {
            border-top: 1px solid var(--glass-edge);
        }

        .setting-name {
            font-size: 9px;
            font-weight: 700;
            letter-spacing: 0.12em;
            color: var(--fg);
        }

        /* Toggle switch */
        .toggle-wrap { display: flex; align-items: center; gap: 8px; }
        .toggle-wrap input[type="checkbox"] { display: none; }
        .toggle-track {
            width: 30px; height: 16px;
            background: var(--dim);
            border-radius: 8px;
            cursor: pointer;
            position: relative;
            transition: background 0.2s;
            flex-shrink: 0;
        }
        .toggle-track::after {
            content: '';
            position: absolute;
            top: 3px; left: 3px;
            width: 10px; height: 10px;
            background: rgba(2,3,8,0.9);
            border-radius: 50%;
            transition: transform 0.2s;
        }
        input[type="checkbox"]:checked + .toggle-track { background: var(--accent); }
        input[type="checkbox"]:checked + .toggle-track::after { transform: translateX(14px); }

        /* Speed buttons */
        .speed-options { display: flex; gap: 4px; }
        .speed-btn {
            font-family: var(--font);
            font-size: 8px;
            font-weight: 700;
            letter-spacing: 0.12em;
            color: var(--dim);
            background: none;
            border: 1px solid var(--glass-edge);
            border-radius: 1px;
            padding: 4px 8px;
            cursor: pointer;
            text-transform: uppercase;
            transition: color 0.15s, border-color 0.15s;
        }
        .speed-btn:hover { color: var(--fg); border-color: rgba(255,255,255,0.14); }
        .speed-btn.active { color: var(--accent); border-color: var(--accent-dim); }

        /* ── CUSTOM TRANSMISSIONS FORM ── */
        .modal-input {
            background: transparent;
            border: 1px solid var(--glass-edge);
            border-radius: 1px;
            color: var(--fg);
            font-family: var(--font);
            font-size: 9px;
            font-weight: 700;
            letter-spacing: 0.08em;
            padding: 5px 8px;
            outline: none;
            text-transform: none;
            cursor: text;
            transition: border-color 0.15s;
            user-select: text;
            min-width: 0;
        }
        .modal-input:focus { border-color: rgba(255, 255, 255, 0.22); }
        .modal-input::placeholder { color: var(--dim); font-weight: 500; }
        /* Hide number input spinners */
        .modal-input[type="number"] { -moz-appearance: textfield; }
        .modal-input[type="number"]::-webkit-inner-spin-button,
        .modal-input[type="number"]::-webkit-outer-spin-button { -webkit-appearance: none; }

        #custom-station-list { max-height: 100px; overflow-y: auto; margin-bottom: 8px; }
        .custom-empty { font-size: 9px; color: var(--dim); letter-spacing: 0.1em; padding: 4px 0; }

        /* ── PICK-MODE LOADER ── */
        @keyframes pick-spin {
            to { transform: rotate(360deg); }
        }
        .pick-loader {
            display: inline-block;
            width: 7px;
            height: 7px;
            border: 1px solid var(--accent-dim);
            border-top-color: var(--accent);
            border-radius: 50%;
            animation: pick-spin 0.55s linear infinite;
            vertical-align: middle;
            margin-right: 5px;
            flex-shrink: 0;
        }

        /* ── PIN TOOLTIP ── */
        #pin-tooltip {
            position: fixed;
            z-index: 200;
            display: none;
            pointer-events: none;
            padding: 5px 10px;
            font-family: var(--font);
            font-size: 9px;
            font-weight: 700;
            letter-spacing: 0.12em;
            white-space: nowrap;
            color: var(--fg);
            background: rgba(12, 15, 22, 0.82);
            border: 1px solid var(--glass-edge);
            border-top: 1px solid var(--glass-rim);
            border-radius: 2px;
            box-shadow: 0 8px 24px -4px rgba(0, 0, 0, 0.6);
        }
    </style>
</head>
<body>

<div id="globe-container"></div>
<div id="pin-tooltip"></div>

<!-- MODAL -->
<div id="modal-overlay">
    <div class="panel" id="modal-box">
        <div id="modal-header">
            <span>GEO<span class="accent">_</span>RADIO</span>
            <button id="modal-close">✕</button>
        </div>

        <div class="modal-section">
            <div class="label">About</div>
            <p class="modal-about-text">A live signal explorer. Browse active broadcasts from thousands of radio stations across the globe in real time. Select any transmission point to tune in and establish a link.</p>
        </div>

        <div class="modal-section">
            <div class="label">Settings</div>

            <div class="setting-row">
                <span class="setting-name">Eco Mode (Low Compute)</span>
                <label class="toggle-wrap">
                    <input type="checkbox" id="setting-ecomode">
                    <span class="toggle-track"></span>
                </label>
            </div>

            <div class="setting-row">
                <span class="setting-name">Auto-Rotate</span>
                <label class="toggle-wrap">
                    <input type="checkbox" id="setting-autorotate" checked>
                    <span class="toggle-track"></span>
                </label>
            </div>

            <div class="setting-row">
                <span class="setting-name">Rotation Speed</span>
                <div class="speed-options">
                    <button class="speed-btn" data-speed="0.2">Slow</button>
                    <button class="speed-btn active" data-speed="0.5">Normal</button>
                    <button class="speed-btn" data-speed="1.2">Fast</button>
                </div>
            </div>
        </div>

        <div class="modal-section">
            <div class="label">Globe Visualizer</div>

            <div class="setting-row">
                <span class="setting-name">Enabled</span>
                <label class="toggle-wrap">
                    <input type="checkbox" id="setting-viz-enabled" checked>
                    <span class="toggle-track"></span>
                </label>
            </div>

            <div class="setting-row">
                <span class="setting-name">Mode</span>
                <div class="speed-options">
                    <button class="speed-btn viz-mode-btn active" data-mode="0">SCAN</button>
                    <button class="speed-btn viz-mode-btn" data-mode="1">ORBIT</button>
                    <button class="speed-btn viz-mode-btn" data-mode="2">FLUX</button>
                </div>
            </div>

            <div class="setting-row">
                <span class="setting-name">Palette</span>
                <div class="speed-options">
                    <button class="speed-btn viz-pal-btn active" data-palette="0">Accent</button>
                    <button class="speed-btn viz-pal-btn" data-palette="1">Cyan</button>
                    <button class="speed-btn viz-pal-btn" data-palette="2">Plasma</button>
                    <button class="speed-btn viz-pal-btn" data-palette="3">Mono</button>
                </div>
            </div>
        </div>

        <div class="modal-section">
            <div class="label">Custom Transmissions</div>

            <!-- LIST VIEW -->
            <div id="custom-list-view">
                <div id="custom-station-list"></div>
                <button id="btn-custom-add" class="speed-btn" style="width:100%;padding:6px 8px;">+ Register Frequency</button>
            </div>

            <!-- ADD FORM (hidden until activated) -->
            <div id="custom-add-view" style="display:none;">
                <div class="setting-row">
                    <input type="text" id="inp-custom-name" class="modal-input" style="width:100%;" placeholder="STATION NAME">
                </div>
                <div class="setting-row">
                    <input type="text" id="inp-custom-url" class="modal-input" style="width:100%;" placeholder="STREAM URL (MP3/AAC)">
                </div>
                <div class="setting-row" style="justify-content:flex-start;gap:5px;">
                    <input type="number" id="inp-custom-lat" class="modal-input" style="width:28%;" placeholder="LAT">
                    <input type="number" id="inp-custom-lng" class="modal-input" style="width:28%;" placeholder="LNG">
                    <button id="btn-custom-pick" class="speed-btn" style="flex:1;">Pick on Map</button>
                </div>
                <div class="setting-row" style="justify-content:flex-end;gap:8px;">
                    <button id="btn-custom-cancel" class="speed-btn">Cancel</button>
                    <button id="btn-custom-save" class="speed-btn" style="color:var(--accent);border-color:var(--accent-dim);">Save</button>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- BRAND -->
<div class="panel" id="brand-box">
    <div class="brand-logo" id="brand-logo">
        <h1>GEO<span>_</span>RADIO</h1>
    </div>
    <div class="brand-coords">
        <span id="lat">00.0000 N</span>
        <span id="lng">00.0000 E</span>
    </div>
</div>

<!-- STATUS -->
<div class="panel" id="status-box">
    <button id="scan-btn">SCAN</button>
    <div class="v-sep"></div>
    <span id="status-txt">STANDBY</span>
    <div id="led" class="led"></div>
</div>

<!-- META -->
<div class="panel" id="meta-box">
    <div class="meta-head">
        <div class="meta-content">
            <div class="label">STATION IDENTITY</div>
            <div id="st-name">--</div>
        </div>
        <button id="star-btn" title="Add to favorites">&#9734;</button>
    </div>

    <div class="meta-row">
        <div class="meta-cell">
            <div class="label">COUNTRY</div>
            <div id="st-country">--</div>
        </div>
        <div class="meta-cell">
            <div class="label">LOCAL TIME</div>
            <div id="st-local-time">--:--</div>
        </div>
    </div>

    <div id="st-tags">--</div>

    <canvas id="visualizer-canvas"></canvas>

    <button id="play-btn">INITIATE LINK</button>
</div>

<!-- SEARCH -->
<div class="panel" id="search-box">
    <div class="search-row">
        <button id="search-prev" class="search-nav-btn" disabled>&#8249;</button>
        <input type="text" id="search-input" placeholder="station · country · tag" spellcheck="false" autocomplete="off" autocorrect="off" autocapitalize="off">
        <button id="search-next" class="search-nav-btn" disabled>&#8250;</button>
    </div>
    <div class="search-footer">
        <span class="search-label">Frequency Search</span>
        <span id="search-count"></span>
    </div>
</div>

<script type="module" src="./js/main.js"></script>
</body>
</html>
